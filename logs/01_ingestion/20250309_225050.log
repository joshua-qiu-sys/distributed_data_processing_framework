2025-03-09 22:50:50 - pyspark_ingestion_app - INFO - Created application logger for application pyspark_ingestion_app
2025-03-09 22:50:54 - pyspark_ingestion_app - INFO - Created Spark session for Pyspark Ingestion App
2025-03-09 22:50:54 - pyspark_ingestion_app - INFO - Successfully read source to target configurations: [{'dataset_name': 'dataset1', 'path': 'data/raw/dataset1', 'src': {'connector': 'local_file', 'file_type': 'parquet'}, 'target': {'connector': 'postgres', 'jdbc_url': 'jdbc:postgresql://localhost:5432', 'database': 'db1', 'schema': 'public', 'table': 'dataset1', 'concurrent_conns': 10, 'batch_size': 10000}}]
2025-03-09 22:50:54 - pyspark_ingestion_app - INFO - Successfully read source data validation configurations: [{'dataset_name': 'dataset1', 'path': 'data/raw/dataset1', 'req_validations': [{'validation_type': 'primary_key_validation', 'cols_to_check': ['product_id']}, {'validation_type': 'null_validation', 'cols_to_check': ['item', 'quantity']}]}]
2025-03-09 22:50:56 - pyspark_ingestion_app - INFO - Loaded file data/raw/dataset1 into Dataframe
2025-03-09 22:50:57 - pyspark_ingestion_app - INFO - [Row(product_id=92000002, item='Value 92000002', quantity=Decimal('92000002.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92880805, item='Value 92880805', quantity=Decimal('92880805.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92000033, item='Value 92000033', quantity=Decimal('92000033.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92880836, item='Value 92880836', quantity=Decimal('92880836.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92000064, item='Value 92000064', quantity=Decimal('92000064.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92880867, item='Value 92880867', quantity=Decimal('92880867.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92000095, item='Value 92000095', quantity=Decimal('92000095.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92880898, item='Value 92880898', quantity=Decimal('92880898.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92000126, item='Value 92000126', quantity=Decimal('92000126.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1), Row(product_id=92880929, item='Value 92880929', quantity=Decimal('92880929.0000000000000000000'), business_date=datetime.date(2025, 1, 1), year=2025, month=1, day=1)]
2025-03-09 22:50:57 - pyspark_ingestion_app - INFO - Validations to perform: ['primary_key_validation', 'null_validation']
2025-03-09 22:50:57 - pyspark_ingestion_app - INFO - Primary key cols: ['product_id']
2025-03-09 22:50:57 - pyspark_ingestion_app - INFO - Non-nullable cols: ['item', 'quantity']
